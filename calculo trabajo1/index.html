<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>MotoSIM â€” Kawasaki H2</title>
  <link rel="stylesheet" href="style.css">
  <link href="https://fonts.googleapis.com/css2?family=Rajdhani:wght@400;600;700&family=Orbitron:wght@400;700;900&family=Share+Tech+Mono&display=swap" rel="stylesheet">
</head>
<body>

<!-- PANTALLA INICIO -->
<div id="inicio">
  <div class="intro-bg"></div>
  <div class="intro-content">
    <div class="logo-ring"><div class="ring-inner"></div><span class="ring-icon">âš¡</span></div>
    <h1 class="titulo-principal">Moto<span class="accent">SIM</span></h1>
    <p class="subtitulo">Kawasaki Ninja H2 Â· CÃ¡lculo Integral Â· Movimiento Variado</p>
    <div class="intro-badges">
      <span class="badge">âˆ« Riemann</span>
      <span class="badge">âˆ« Trapezoidal</span>
      <span class="badge">a(t) PolinÃ³mica</span>
      <span class="badge">ğŸ›£ï¸ Eventos de Ruta</span>
      <span class="badge">â›½ Curva-U</span>
    </div>
    <button class="btn-start" onclick="iniciar()">
      <span>INICIAR SIMULACIÃ“N</span>
      <span class="btn-arrow">â†’</span>
      <span class="btn-glow"></span>
    </button>
  </div>
</div>

<!-- SIMULADOR -->
<div id="simulador">

  <aside id="panel">
    <div class="panel-header">
      <span class="panel-title">MotoSIM</span>
      <span class="panel-sub">Kawasaki Ninja H2 â€” Panel de Control</span>
    </div>

    <!-- MRUV SIMPLE -->
    <div class="section-block">
      <h3 class="section-label">âš¡ Variables MRUV</h3>
      <div class="input-group">
        <label>vâ‚€ â€” Velocidad inicial (m/s)</label>
        <input type="number" id="v0" value="0" step="0.5" oninput="actualizarPreview()">
      </div>
      <div class="input-group">
        <label>a â€” AceleraciÃ³n constante (m/sÂ²)</label>
        <input type="number" id="a0" value="4" step="0.5" oninput="actualizarPreview()">
      </div>
      <div class="input-group">
        <label>T â€” Tiempo total (s)</label>
        <input type="number" id="t" value="15" min="5" max="60" oninput="actualizarPreview()">
      </div>
      <div class="formula-preview" id="formulaPreview">
        a(t) = 4 m/sÂ² &nbsp;|&nbsp; v(t) = 0 + 4t &nbsp;|&nbsp; x(t) = 2tÂ²
      </div>
    </div>

    <!-- EVENTOS DE RUTA -->
    <div class="section-block">
      <h3 class="section-label">ğŸ›£ï¸ Eventos en la Ruta</h3>
      <p class="section-desc">Perturbaciones que modifican a(t) automÃ¡ticamente durante la simulaciÃ³n</p>

      <div class="evento-list">

        <div class="evento-item" id="ev-bache">
          <div class="evento-header">
            <label class="evento-toggle">
              <input type="checkbox" id="chk-bache" checked>
              <span class="toggle-slider"></span>
            </label>
            <span class="evento-icon">ğŸ’¥</span>
            <span class="evento-nombre">Bache en el asfalto</span>
          </div>
          <div class="evento-body">
            <div class="ev-row">
              <span>Momento (s)</span>
              <input type="number" id="t-bache" value="4" step="0.5" min="0">
            </div>
            <div class="ev-row">
              <span>DesaceleraciÃ³n (m/sÂ²)</span>
              <input type="number" id="d-bache" value="-6" step="1">
            </div>
            <div class="ev-row">
              <span>DuraciÃ³n (s)</span>
              <input type="number" id="dur-bache" value="0.8" step="0.1" min="0.1">
            </div>
            <p class="ev-desc">Impacto brusco: spike negativo en a(t). La moto absorbe el golpe y recupera.</p>
          </div>
        </div>

        <div class="evento-item" id="ev-ciudad">
          <div class="evento-header">
            <label class="evento-toggle">
              <input type="checkbox" id="chk-ciudad" checked>
              <span class="toggle-slider"></span>
            </label>
            <span class="evento-icon">ğŸ™ï¸</span>
            <span class="evento-nombre">Zona urbana / trÃ¡fico</span>
          </div>
          <div class="evento-body">
            <div class="ev-row">
              <span>Inicio (s)</span>
              <input type="number" id="t-ciudad" value="6" step="0.5" min="0">
            </div>
            <div class="ev-row">
              <span>DesaceleraciÃ³n (m/sÂ²)</span>
              <input type="number" id="d-ciudad" value="-3" step="0.5">
            </div>
            <div class="ev-row">
              <span>DuraciÃ³n (s)</span>
              <input type="number" id="dur-ciudad" value="3" step="0.5" min="0.5">
            </div>
            <p class="ev-desc">Frenada suave sostenida. a(t) cae gradualmente (rampa descendente).</p>
          </div>
        </div>

        <div class="evento-item" id="ev-semaforo">
          <div class="evento-header">
            <label class="evento-toggle">
              <input type="checkbox" id="chk-semaforo">
              <span class="toggle-slider"></span>
            </label>
            <span class="evento-icon">ğŸš¦</span>
            <span class="evento-nombre">SemÃ¡foro en rojo</span>
          </div>
          <div class="evento-body">
            <div class="ev-row">
              <span>Momento (s)</span>
              <input type="number" id="t-semaforo" value="10" step="0.5" min="0">
            </div>
            <div class="ev-row">
              <span>DesaceleraciÃ³n (m/sÂ²)</span>
              <input type="number" id="d-semaforo" value="-5" step="0.5">
            </div>
            <div class="ev-row">
              <span>DuraciÃ³n (s)</span>
              <input type="number" id="dur-semaforo" value="2" step="0.5" min="0.5">
            </div>
            <p class="ev-desc">Frenada progresiva hasta casi detenerse. Luego retoma la curva base.</p>
          </div>
        </div>

        <div class="evento-item" id="ev-curva">
          <div class="evento-header">
            <label class="evento-toggle">
              <input type="checkbox" id="chk-curva">
              <span class="toggle-slider"></span>
            </label>
            <span class="evento-icon">ğŸ”„</span>
            <span class="evento-nombre">Curva pronunciada</span>
          </div>
          <div class="evento-body">
            <div class="ev-row">
              <span>Inicio (s)</span>
              <input type="number" id="t-curva" value="9" step="0.5" min="0">
            </div>
            <div class="ev-row">
              <span>DesaceleraciÃ³n (m/sÂ²)</span>
              <input type="number" id="d-curva" value="-2.5" step="0.5">
            </div>
            <div class="ev-row">
              <span>DuraciÃ³n (s)</span>
              <input type="number" id="dur-curva" value="2.5" step="0.5" min="0.5">
            </div>
            <p class="ev-desc">DesaceleraciÃ³n suave en curva (seno amortiguado). Recupera al salir.</p>
          </div>
        </div>

        <div class="evento-item" id="ev-turbo">
          <div class="evento-header">
            <label class="evento-toggle">
              <input type="checkbox" id="chk-turbo">
              <span class="toggle-slider"></span>
            </label>
            <span class="evento-icon">ğŸš€</span>
            <span class="evento-nombre">Recta libre â€” Turbo</span>
          </div>
          <div class="evento-body">
            <div class="ev-row">
              <span>Inicio (s)</span>
              <input type="number" id="t-turbo" value="12" step="0.5" min="0">
            </div>
            <div class="ev-row">
              <span>AceleraciÃ³n extra (m/sÂ²)</span>
              <input type="number" id="d-turbo" value="3" step="0.5">
            </div>
            <div class="ev-row">
              <span>DuraciÃ³n (s)</span>
              <input type="number" id="dur-turbo" value="2" step="0.5" min="0.5">
            </div>
            <p class="ev-desc">Recta despejada: el H2 abre el turbo y acelera por encima de la curva base.</p>
          </div>
        </div>

      </div>
    </div>

    <!-- GASOLINA -->
    <div class="section-block">
      <h3 class="section-label">â›½ Gasolina â€” Curva U</h3>
      <div class="input-group">
        <label>Consumo Ã³ptimo (L/100km)</label>
        <input type="number" id="consumo" value="4.5" min="1" step="0.5">
      </div>
      <div class="input-group">
        <label>Precio (S/./L)</label>
        <input type="number" id="precio" value="1.5" min="0.1" step="0.1">
      </div>
    </div>

    <!-- INTEGRACIÃ“N -->
    <div class="section-block">
      <h3 class="section-label">âˆ« IntegraciÃ³n numÃ©rica</h3>
      <div class="input-group">
        <label>Subdivisiones n</label>
        <input type="number" id="nRect" value="14" min="2" max="200">
      </div>
      <div class="radio-group">
        <label><input type="radio" name="metodo" value="left" checked> Riemann Izq.</label>
        <label><input type="radio" name="metodo" value="mid"> Punto Medio</label>
        <label><input type="radio" name="metodo" value="right"> Riemann Der.</label>
        <label><input type="radio" name="metodo" value="trap"> Trapezoidal</label>
      </div>
    </div>

    <!-- CONTROLES -->
    <div class="controles">
      <button class="btn btn-primary" onclick="simular()">â–¶ SIMULAR</button>
      <button class="btn btn-secondary" id="btnPausa" onclick="pausar()">â¸ PAUSA</button>
      <button class="btn btn-danger" onclick="resetear()">â†º RESET</button>
    </div>

    <div id="resultado" class="resultado-box"></div>
  </aside>

  <!-- MAIN -->
  <main id="main-area">
    <div class="canvas-wrapper">
      <canvas id="escena"></canvas>
      <!-- HUD -->
      <div class="hud" id="hud" style="display:none">
        <div class="hud-item"><span class="hud-lbl">VELOCIDAD</span><span class="hud-val" id="hudVel">0.00 m/s</span></div>
        <div class="hud-sep"></div>
        <div class="hud-item"><span class="hud-lbl">DISTANCIA</span><span class="hud-val" id="hudDist">0.00 m</span></div>
        <div class="hud-sep"></div>
        <div class="hud-item"><span class="hud-lbl">TIEMPO</span><span class="hud-val" id="hudTiempo">0.00 s</span></div>
        <div class="hud-sep"></div>
        <div class="hud-item"><span class="hud-lbl">ACEL.</span><span class="hud-val" id="hudAcel">0.00 m/sÂ²</span></div>
      </div>
      <!-- NotificaciÃ³n de evento -->
      <div class="evento-notif" id="eventoNotif"></div>
    </div>

    <div id="graficas-area">
      <div class="tabs">
        <button class="tab active" onclick="cambiarTab('velocidad',this)">v(t) Velocidad</button>
        <button class="tab" onclick="cambiarTab('aceleracion',this)">a(t) AceleraciÃ³n</button>
        <button class="tab" onclick="cambiarTab('distancia',this)">x(t) Distancia</button>
        <button class="tab" onclick="cambiarTab('integral',this)">âˆ« MÃ©todos</button>
        <button class="tab" onclick="cambiarTab('gasolina',this)">â›½ Gasolina</button>
        <button class="tab" onclick="cambiarTab('educativo',this)">ğŸ“š TeorÃ­a</button>
      </div>

      <div id="tab-velocidad" class="tab-content active"><canvas id="grafVelocidad"></canvas></div>
      <div id="tab-aceleracion" class="tab-content"><canvas id="grafAceleracion"></canvas></div>
      <div id="tab-distancia" class="tab-content"><canvas id="grafDistancia"></canvas></div>

      <div id="tab-integral" class="tab-content">
        <div class="integral-wrapper">

          <!-- BARRA DE CONTROLES SUPERIOR -->
          <div class="integral-toolbar">

            <div class="toolbar-group">
              <span class="toolbar-label">GRÃFICA</span>
              <div class="graf-selector">
                <button class="graf-btn active" id="gbtn-v" onclick="setGrafIntegral('v',this)">v(t) Velocidad</button>
                <button class="graf-btn" id="gbtn-a" onclick="setGrafIntegral('a',this)">a(t) AceleraciÃ³n</button>
                <button class="graf-btn" id="gbtn-x" onclick="setGrafIntegral('x',this)">x(t) Distancia</button>
              </div>
            </div>

            <div class="toolbar-group">
              <span class="toolbar-label">ZOOM</span>
              <div class="zoom-controls">
                <button class="zoom-btn" onclick="zoomIntegral(1.4)" title="Acercar">ï¼‹</button>
                <button class="zoom-btn" onclick="zoomIntegral(1/1.4)" title="Alejar">ï¼</button>
                <button class="zoom-btn" onclick="resetZoomIntegral()" title="Reset zoom">âŠ™</button>
                <span class="zoom-level" id="zoomLabel">100%</span>
              </div>
            </div>

            <div class="toolbar-group axis-info">
              <span class="axis-badge x-axis">Eje X â€” Tiempo (s)</span>
              <span class="axis-badge y-axis" id="yAxisLabel">Eje Y â€” Velocidad (m/s)</span>
            </div>

          </div>

          <!-- LAYOUT PRINCIPAL -->
          <div class="integral-main">
            <div class="integral-canvas-box">
              <canvas id="grafIntegral"></canvas>
            </div>
            <div class="side-panel">
              <h4 class="info-title">âˆ« ComparaciÃ³n</h4>
              <div id="integral-graf-desc" class="info-desc"></div>
              <div id="integral-tabla"></div>
              <div class="legend-box" style="margin-top:8px">
                <div class="leg"><span class="dot" style="background:#00eaff"></span><span id="leg-curva">Curva real v(t)</span></div>
                <div class="leg"><span class="dot" style="background:rgba(255,122,0,0.7)"></span>Riemann</div>
                <div class="leg"><span class="dot" style="background:rgba(180,0,255,0.6)"></span>Trapecio</div>
              </div>
            </div>
          </div>

        </div>
      </div>

      <div id="tab-gasolina" class="tab-content">
        <div class="split-layout">
          <canvas id="grafGasolina"></canvas>
          <div class="side-panel">
            <h4 class="info-title">â›½ Consumo Curva-U</h4>
            <p class="info-desc">Los eventos de frenada reducen el consumo momentÃ¡neamente, pero las aceleraciones posteriores lo disparan.</p>
            <canvas id="grafCurvaU" style="width:100%;height:80px;margin-top:6px;border-radius:6px;"></canvas>
            <div id="gasolina-resultado" style="margin-top:8px"></div>
          </div>
        </div>
      </div>

      <div id="tab-educativo" class="tab-content educativo">
        <div class="edu-scroll">
          <h3 class="edu-titulo">ğŸ“ CÃ¡lculo Integral en el Movimiento Real</h3>
          <div class="edu-grid">
            <div class="edu-card">
              <h4>MRUV + Eventos</h4>
              <p>La base es MRUV puro (a constante). Los eventos suman perturbaciones puntuales:</p>
              <div class="formula">a_total(t) = a + Î£ evento_i(t)</div>
              <p>Sin eventos, v(t) y x(t) son lineales y cuadrÃ¡ticas. Con eventos, forman curvas reales.</p>
            </div>
            <div class="edu-card">
              <h4>MRUV â€” FÃ³rmulas base</h4>
              <p>Con aceleraciÃ³n constante <strong>a</strong>:</p>
              <div class="formula">v(t) = vâ‚€ + aÂ·t &nbsp;(lineal)</div>
              <div class="formula">x(t) = vâ‚€t + Â½Â·aÂ·tÂ² &nbsp;(parÃ¡bola)</div>
              <p>La integral de a constante da v(t) lineal, y la integral de v(t) da x(t) cuadrÃ¡tica.</p>
            </div>
            <div class="edu-card">
              <h4>Bache â€” FunciÃ³n Gaussiana</h4>
              <p>Un bache es un impulso brusco muy corto. Se modela como campana:</p>
              <div class="formula">e(t) = d Â· e^(âˆ’(tâˆ’tâ‚€)Â²/2ÏƒÂ²)</div>
              <p>Al integrarlo sobre v(t), se ve la <strong>pÃ©rdida de velocidad</strong> como Ã¡rea negativa bajo la curva.</p>
            </div>
            <div class="edu-card">
              <h4>Zona Urbana / Curva â€” Seno</h4>
              <p>Frenada progresiva suave: se modela con medio perÃ­odo de seno:</p>
              <div class="formula">e(t) = d Â· sin(Ï€Â·(tâˆ’tâ‚€)/dur)</div>
              <p>Esto convierte la lÃ­nea recta de v(t) en una <strong>curva</strong> con mÃ­nimo local.</p>
            </div>
            <div class="edu-card">
              <h4>Riemann vs Trapezoidal</h4>
              <p>Con v(t) curva por eventos, el error entre mÃ©todos se vuelve visible:</p>
              <div class="formula">R = Î£ f(táµ¢)Â·Î”t â†’ Error O(Î”t)</div>
              <div class="formula">T = Î£ [f(táµ¢)+f(táµ¢â‚Šâ‚)]/2Â·Î”t â†’ Error O(Î”tÂ²)</div>
              <p>El trapecio es mÃ¡s preciso en zonas de cambio brusco como el bache.</p>
            </div>
            <div class="edu-card">
              <h4>â›½ Consumo No Lineal</h4>
              <p>Las frenadas bajan el consumo momentÃ¡neamente, pero reacelerarse lo dispara:</p>
              <div class="formula">f(v) = CÂ·[1 + Î±Â·(vâˆ’vâ‚’â‚šâ‚œ)Â²/vâ‚’â‚šâ‚œÂ²]</div>
              <div class="formula">Litros = âˆ«â‚€áµ€ f(v(t))Â·v(t)/1000 dt</div>
            </div>
            <div class="edu-card">
              <h4>TFC â€” Teorema Fundamental</h4>
              <p>La posiciÃ³n es la integral de la velocidad, que a su vez integra la aceleraciÃ³n:</p>
              <div class="formula">v(t) = vâ‚€ + âˆ«â‚€áµ— a_total(Ï„)dÏ„</div>
              <div class="formula">x(t) = xâ‚€ + âˆ«â‚€áµ— v(Ï„)dÏ„</div>
              <p>Cada evento en a(t) modifica el Ã¡rea y por tanto la trayectoria completa.</p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </main>
</div>

<script src="script.js"></script>
</body>
</html>
